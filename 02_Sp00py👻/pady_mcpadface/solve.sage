from telnetlib import Telnet
from sage.all import jacobi_symbol
from sys import argv

n=23946008544227658126007712372803958643232141489757386834260550742271224503035086875887914418064683964046938371640632153677880813529023769841157840969433316734058706481517878257755290676559343682013294580085557476138201639446709290119631383493940405818550255561589074538261117055296294434994144540224412018398452371792093095280080422459773487177339595746894989682038387107119249733105558301840478252766907821053044992141741079156669562032221433390029219634673005161989684970682781410366155504440886376453225497112165607897302209008685179791558898003720802478389914297472563728836647547791799771532020349546729665006643
e=65537

def getL():
    t = Telnet(argv[1], int(argv[2]))
    t.read_until(b"~"*50)
    t.read_until(b"\n")
    t.read_until(b"\n")
    t.read_until(b"\n")
    r=[]
    for l in t.read_all().split():
    	r.append(int(l))
    return r
    
    
def canBeZero(i):
    return jacobi_symbol(i,n)==1
    
ll = []
for _ in range(16):
    ll.append(getL())
    
res = []
print([len(i) for i in ll])
for i in range(len(ll[0])):
    zero = all(canBeZero(j[i]) for j in ll)
    res.append(0 if zero else 1)
res=int(''.join(map(str,res)),2)
print(bytes.fromhex(hex(res)[2:]))
